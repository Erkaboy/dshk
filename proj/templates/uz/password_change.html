{% extends 'uz/master.html' %}

 {% block content %}

  {% load i18n %}
{% load static %}
 {% csrf_token %}



   <div class="container" id="main_body">
       <hr>
       <h4 class="text text-center  text-info">{{company.companyname}}</h4>
       <br>
           <div class="row">
<!--               <div class="col-md-3">-->
<!--                   <img src="{% static 'newimages/logo.png' %}" style="" alt="">-->
<!--               </div>-->

               <div class="col-md-12">

                   <div class="col-md-1">

                   </div>

                      <div class="col-md-10">
<!--                                {% if messages %}-->
<!--                                        <ul class="messages text text-center text-success">-->
<!--                                            {% for message in messages %}-->
<!--                                               <div class="alert alert-success">-->
<!--                                                <li style="font-size:20px" {% if message.tags %} class="{{ message.tags }}" {% endif %}><b>{{ message }}</b></li>-->
<!--                                                </div>-->

<!--                                            {% endfor %}-->
<!--                                        </ul>-->
<!--                                    {% endif %}-->
                                <form method="POST">
                                    {% csrf_token %}

                                     <div class="form-group" style="width:100%;" id="content">
<!--                                         <h3 class="text text-center">Tashkilot ma'lumotlari</h3>-->
                                         <br>
                                         <table class="table table-hover" style="font-size:17px">
                                            <tbody>
                                              <tr>
                                                <td><label>F.I.SH:</label></td>
                                                <td><input type="text"  value="{{ worker.fullname }}" id="fullname" name="fullname" class="form-control"></td>
                                              </tr>

                                              <tr>
                                               <td><label>Tel:</label></td>
                                                <td><input type="text" value="{{ worker.tel_number }}" id="tel_number" name="tel_number" class="form-control"></td>
                                              </tr>

                                              <tr>
                                               <td><label>Email:</label></td>
                                                <td><input type="email"  value="{{ worker.email }}" id="email" name="email"  class="form-control"></td>
                                              </tr>

                                              <tr>
                                               <td><label>Passport raqami:</label></td>
                                                <td><input type="text" value="{{ worker.passport_number }}" id="passport_number" name="passport_number"  class="form-control"></td>
                                              </tr>
                                             <tr>

                                              <tr>

                                               <td><label>Ruhsat berish:</label></td>

                                                 <td>

                                                       <div class="form-group">
                                                        <input type="radio"   name="checkbox" class="checkbox1" id="id1" value="1"> &nbsp;
                                                        <label for="id1" style="font-style: italic;font-weight: 400 !important" >  Barcha ma'lumotlarni ko'rish taxrirlash imkoniyatisiz </label>
                                                    </div>

                                                     <div class="form-group">
                                                        <input type="radio"  name="checkbox" class="checkbox1" id="id2" value="2"  data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1"> &nbsp;
                                                        <label for="id2" style="font-style: italic;font-weight: 400 !important"  data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1" >
                                                            Barcha ma'lumotlarni ko'rish , yangi ma'lumotlarni kiritish va o'zgartirish (o'chirish)
                                                        </label>
                                                    </div>

                                                     <div style="margin-left:45px" id="collapse1" class="collapse " aria-labelledby="headingOne" data-parent="#accordion">
<!--                                                         <label href="#" style="font-size:17px;font-weight: 400 !important">Ruhsat etilgan qatlamlarni tanlang </label><br>-->
                                                         <ul>
                                                             <li><input type="checkbox" class="checkbox1" name="checkbox" id="id4" value="4"> &nbsp; <label for="id4" style="font-weight: 400 !important">  Funkisonal zonalar </label></li>
                                                             <li><input type="checkbox" class="checkbox1" name="checkbox" id="id5" value="5"> &nbsp; <label for="id5" style="font-weight: 400 !important">  Geologik rayonlashtirish </label></li>
                                                             <li><input type="checkbox" class="checkbox1" name="checkbox" id="id6" value="6"> &nbsp; <label for="id6" style="font-weight: 400 !important">  Kadastr ma'lumotlari </label></li>
                                                             <li><input type="checkbox" class="checkbox1" name="checkbox" id="id7" value="7"> &nbsp; <label for="id7" style="font-weight: 400 !important">  Qishloq ho'shalik yerlari </label></li>
                                                             <li><input type="checkbox" class="checkbox1" name="checkbox" id="id8" value="8"> &nbsp; <label for="id8" style="font-weight: 400 !important">  Mahalla chegaralari </label></li>
                                                             <li><input type="checkbox" class="checkbox1"  name="checkbox" id="id9" value="9"> &nbsp; <label for="id9" style="font-weight: 400 !important">  Qizil chiziqlar </label></li>
                                                         </ul>

                                                         <br>
                                                    </div>

                                                     <div class="form-group">
                                                            <input type="radio" class="checkbox1"  name="checkbox" id="id3" value="3"  data-toggle="collapse" data-target="#collapse2" aria-expanded="true" aria-controls="collapse2"> &nbsp;
                                                            <label for="id3" style="font-style: italic;font-weight: 400 !important"  data-toggle="collapse" data-target="#collapse2" aria-expanded="true" aria-controls="collapse2">  Yangi kiritilgan ma'lumotlarni tasdiqlash va barcha ma'lumotlarni ko'rish </label>
                                                     </div>

                                                     <div  style="margin-left:45px" id="collapse2" class="collapse " aria-labelledby="headingOne" data-parent="#accordion">
<!--                                                         <b href="#" style="font-size:17px;font-weight: 400 !important" >Ruhsat etilgan qatlamlarni tanlang </b><br>-->
                                                         <ul>
                                                             <li><input type="checkbox" class="checkbox1" name="checkbox" id="id10" value="10"> &nbsp; <label for="id10" style="font-weight: 400 !important">  Funkisonal zonalar </label></li>
                                                             <li><input type="checkbox" class="checkbox1" name="checkbox" id="id11" value="11"> &nbsp; <label for="id11" style="font-weight: 400 !important">  Geologik rayonlashtirish </label></li>
                                                             <li><input type="checkbox" class="checkbox1" name="checkbox" id="id12" value="12"> &nbsp; <label for="id12" style="font-weight: 400 !important">  Kadastr ma'lumotlari </label></li>
                                                             <li><input type="checkbox" class="checkbox1"  name="checkbox" id="id13" value="13"> &nbsp; <label for="id13" style="font-weight: 400 !important">  Qishloq ho'shalik yerlari </label></li>
                                                             <li><input type="checkbox" class="checkbox1" name="checkbox" id="id14" value="14"> &nbsp; <label for="id14" style="font-weight: 400 !important">  Mahalla chegaralari </label></li>
                                                             <li><input type="checkbox" class="checkbox1"  name="checkbox" id="id15" value="15"> &nbsp; <label for="id15" style="font-weight: 400 !important">  Qizil chiziqlar </label></li>
                                                         </ul>

                                                         <br>
                                                    </div>

                                                       <input type="text" style="display:none" name="worker_id" id="worker_id" value="{{worker.id}}">


                                                  </td>


                                              </tr>
                                             <tr>
                                               <td></td>
                                                <td></td>
                                              </tr>

                                            </tbody>
                                         </table>

                                  <br><br>
                                        <div style="float:right;font-weight:bold" >
                                            <div style="float:right;font-weight:bold" >
                                                <a href="#" class="btn btn-success" id="permission_dshk"> <i class="fa fa-check-circle-o" aria-hidden="true"></i> Tasdiqlash</a>
                                                    &nbsp;&nbsp;&nbsp;
                                                <a href="#" class="btn btn-danger" id="permission_delete_dshk"> <i class="fa fa-times-circle" aria-hidden="true"></i> Ruhsatni o'chirish</a>
                                                    &nbsp;
<!--                                                <a href="#" class="btn btn-warning"> <i class="fa fa-random" aria-hidden="true"></i> Ruhsatni o'zgartirish</a>-->
                                                     &nbsp;
                                                <a href="#" id="info_update" class="btn btn-success"> <i class="fa fa-undo" aria-hidden="true"></i> Yangilash</a>

                                        </div>
                                        </div>
                                    <br>
                                    </div>
                         </form>
                        </div>

                    <div class="col-md-1">

                   </div>





                    </form>

               </div>
           </div>
       <br>
  <hr>


   </div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script>
$(document).ready(function(){
    var string = "{{ worker.permissions }}";
    var text = string.split(",");
    array  = [];
    array = array.concat(text);
    var one=document.getElementById('id2');
    var two=document.getElementById('id3');

    for (var i = 0; i < array.length; i++) {
           document.getElementById('id'+array[i]).checked = true;

           if(document.getElementById('id'+array[i]).value == one.value){
                 $('#id2').click();

           }
           else if (document.getElementById('id'+array[i]).value == two.value){
                $('#id3').click();
           }

    }

});
</script>
<script type="text/javascript">
$(document).ready(function(){
    $("#permission_dshk").click(function(event) {
        var data = new FormData();
        data.append("csrfmiddlewaretoken", document.getElementsByName("csrfmiddlewaretoken")[0].value);
        event.preventDefault()
        data.append("worker_id", $('#worker_id').val());
        data.append("email", $('#email').val());
        data.append("fullname", $('#fullname').val());
        data.append("passport_number", $('#passport_number').val());

        $.ajax({
            type: 'POST',
            url: '{% url 'permission_dshk' %}',
            data: data,
            cache: false,
            contentType: false,
            processData: false,

            success: function (result){
                 alert("Tasdiqlandi orqaga qaytishingiz mumkin.Bu foydalanuvchiga login va parol email berilgan email adresga yuborildi !");
            },

            error: function(){
                 alert('Serverga yubara olmaymiz !! ');
            }

        });


        });
    });
</script>



<script type="text/javascript">
$(document).ready(function(){
    $("#permission_delete_dshk").click(function(event) {
        var data = new FormData();
        data.append("csrfmiddlewaretoken", document.getElementsByName("csrfmiddlewaretoken")[0].value);
        event.preventDefault()
        data.append("worker_id", $('#worker_id').val());
        $.ajax({
            type: 'POST',
            url: '{% url 'permission_delete_dshk' %}',
            data: data,
            cache: false,
            contentType: false,
            processData: false,

            success: function (result){
                 alert("Ruhsat olib tashlandi orqaga qaytishingiz mumkin");
            },

            error: function(){
              alert('Serverga yubara olmaymiz !! ');
            }

        });


        });
    });
</script>

<script type="text/javascript">
$(document).ready(function(){
    $("#info_update").click(function(event) {
        var data = new FormData();
        data.append("csrfmiddlewaretoken", document.getElementsByName("csrfmiddlewaretoken")[0].value);
        event.preventDefault()
        data.append("worker_id", $('#worker_id').val());
        data.append("fullname", $('#fullname').val());
        data.append("email", $('#email').val());
        data.append("tel_number", $('#tel_number').val());
        data.append("passport_number", $('#passport_number').val());

        var array = [];
        $(".checkbox1:checked").each(function() {
                array.push($(this).val());
            });

        data.append("permissions", array);
        $.ajax({
            type: 'POST',
            url: '{% url 'info_update' %}',
            data: data,
            cache: false,
            contentType: false,
            processData: false,

            success: function (result){
                  alert("Malumotlar orqaga qaytishingiz mumkin");
            },

            error: function(){
              alert('Serverga yubara olmaymiz !! ');
            }

        });


        });
    });
</script>

{% endblock %}
